import{aE as o,J as _}from"./index-895aba94.js";/* empty css              *//* empty css              */import"./index-8c6623a3.js";/* empty css              *//* empty css              */import{A as g}from"./index-8c0371b6.js";/* empty css              */import{s as E}from"./SimpleHeader-f2f1910e.js";import{g as L,c as A,E as D,D as b}from"./address-4a6b7414.js";import{a3 as w,u as k,r as R,Q as $,o as T,a as j,c as f}from"./_plugin-vue_export-helper-730fb40d.js";import"./index-68a0f58b.js";import"./use-id-278a301c.js";import"./index-d983282c.js";import"./index-db4e5443.js";import"./index-a9fd7f12.js";import"./index-f6e9c29d.js";const B={class:"address-edit-box"},ee={__name:"AddressEdit",setup(C){const l=w(),m=k(),e=R({areaList:{province_list:{},city_list:{},county_list:{}},searchResult:[],type:"add",addressId:"",addressInfo:{},from:l.query.from});$(async()=>{let t={},a={},d={};o.getLev1().forEach(s=>{t[s.id]=s.text,o.getLev2(s.id).forEach(r=>{a[r.id]=r.text,o.getLev3(r.id).forEach(i=>d[i.id]=i.text)})}),e.areaList.province_list=t,e.areaList.city_list=a,e.areaList.county_list=d;const{addressId:u,type:p,from:h}=l.query;if(e.addressId=u,e.type=p,e.from=h||"",p=="edit"){const{data:s}=await L(u);let r="";const i=o.getLev1();Object.entries(e.areaList.county_list).forEach(([c,x])=>{if(x==s.regionName){const I=i.findIndex(n=>n.id.substr(0,2)==c.substr(0,2)),N=Object.entries(e.areaList.city_list).filter(([n,F])=>n.substr(0,4)==c.substr(0,4))[0];i[I].text==s.provinceName&&N[1]==s.cityName&&(r=c)}}),e.addressInfo={id:s.addressId,name:s.userName,tel:s.userPhone,province:s.provinceName,city:s.cityName,county:s.regionName,addressDetail:s.detailAddress,areaCode:r,isDefault:!!s.defaultFlag}}});const y=async t=>{const a={userName:t.name,userPhone:t.tel,provinceName:t.province,cityName:t.city,regionName:t.county,detailAddress:t.addressDetail,defaultFlag:t.isDefault?1:0};e.type=="edit"&&(a.addressId=e.addressId),await e.type=="add"?A(a):D(a),_("保存成功"),setTimeout(()=>{m.back()},1e3)},v=async()=>{await b(e.addressId),_("删除成功"),setTimeout(()=>{m.back()},1e3)};return(t,a)=>{const d=g;return T(),j("div",B,[f(E,{name:`${e.type=="add"?"新增地址":"编辑地址"}`},null,8,["name"]),f(d,{class:"edit","area-list":e.areaList,"address-info":e.addressInfo,"show-delete":e.type=="edit","show-set-default":"","show-search-result":"","search-result":e.searchResult,"area-columns-placeholder":["请选择","请选择","请选择"],onSave:y,onDelete:v},null,8,["area-list","address-info","show-delete","search-result"])])}}};export{ee as default};
